<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>writeup.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}@import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:"Roboto Condensed",Tauri,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;background-color:rgba(0,0,0,.02);padding:.2em .5em;border:1px solid #efefef}.haroopad pre>code{font-size:1em;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">
<h1 id="reverse"><a name="reverse" href="#reverse"></a>Reverse</h1><h2 id="re100"><a name="re100" href="#re100"></a>Re100</h2><p>运行起来main函数有个ptrace反调试，修改返回值过了。之后输入的12位字符串与”ZzAwZF9DcjRrM3JfZzBfb24=”循环异或再异或7，通过这个函数计算最后获得的返回是Congratulations? Key is XDCTF{Input}，是个问号，在.fini_array中还有一个相似的函数再进行一次验证，这次验证成功后会把问号改成感叹号，所以正在的验证应该是.fini_array中的。而两个函数的差别就是第一个要异或7，.fini_array中的不异或7.</p><p><img src="img/1.png" alt=""></p><p>第二步位置变换</p><p><img src="img/2.png" alt=""></p><p>第三步判断异或之后如果小于0x1f,就加0x20</p><p><img src="img/3.png" alt=""></p><p>最后结果与[0x3B, 0x25, 0x23, 0x38, 0x34, 0x38, 0x4E, 0x21, 0x30, 0x5A, 0x3F, 0x37, 0x27, 0x25, 0x32, 0x33, 0x5D, 0x2F, 0x35, 0x23, 0x31, 0x22, 0x59, 0x58]比较</p><p>解密代码：</p><pre><code data-origin="<pre><code>#coding=utf-8


key = [0x3B, 0x25, 0x23, 0x38, 0x34, 0x38, 0x4E, 0x21, 0x30, 0x5A, 0x3F, 0x37, 0x27, 0x25, 0x32, 0x33, 0x5D, 0x2F, 0x35, 0x23, 0x31, 0x22, 0x59, 0x58]
res = &quot;&quot;
key2 = &quot;ZzAwZF9DcjRrM3JfZzBfb24=&quot;

for i in range(24):
    if key[i] &amp;gt; 0x1f and key[i] &amp;lt;= 0x3f:
        key[i] = key[i] - 0x20

print key
for i in range(12):
    tmp = key[i]
    key[i] = key[17 - i]
    key[17 - i] = tmp

print key
print key2

for i in range(12):
    res += chr(key[i] ^ ord(key2[i]))


print res
print len(res)
</code></pre>">#coding=utf-8


key = [0x3B, 0x25, 0x23, 0x38, 0x34, 0x38, 0x4E, 0x21, 0x30, 0x5A, 0x3F, 0x37, 0x27, 0x25, 0x32, 0x33, 0x5D, 0x2F, 0x35, 0x23, 0x31, 0x22, 0x59, 0x58]
res = ""
key2 = "ZzAwZF9DcjRrM3JfZzBfb24="

for i in range(24):
    if key[i] &gt; 0x1f and key[i] &lt;= 0x3f:
        key[i] = key[i] - 0x20

print key
for i in range(12):
    tmp = key[i]
    key[i] = key[17 - i]
    key[17 - i] = tmp

print key
print key2

for i in range(12):
    res += chr(key[i] ^ ord(key2[i]))


print res
print len(res)
</code></pre><p><img src="img/4.png" alt=""><br>转为小写即可</p><hr class="section"><h2 id="re200"><a name="re200" href="#re200"></a>Re200</h2><p>代码加密保存，运行时解密，首先ida找到被加密代码的地方，od运行起来之后代码被解密，下断，第二次运行时先禁用断点，运行起来，激活断点就可以断在比较XDCTF的地方</p><p><img src="img/5.png" alt=""></p><p>根据代码一部分一部分修正输入即可复原处flag</p><p><img src="img/6.png" alt=""></p><p>flag: XDCTF{Congra_tUlat$eyOu}</p><h2 id="re400"><a name="re400" href="#re400"></a>Re400</h2><p>输入的name,key全转为大写</p><p>计算machine code</p><p><img src="img/7.png" alt=""></p><p>通过name计算一个35位的key</p><p><img src="img/8.png" alt=""></p><p>把machine code、name计算得到的key和输入的key转存在这里，每个字符用一个dword存放</p><p><img src="img/9.png" alt=""></p><p>变换name计算出的key的顺序</p><p><img src="img/10.png" alt=""></p><p>通过machine code计算出一块数据(a)<br><img src="img/18.png" alt=""></p><p>触发异常，进入SEH</p><p><img src="img/11.png" alt=""></p><p>检测CC断点</p><p><img src="img/12.png" alt=""></p><p>用代码段的代码的二进制填充一段缓冲区</p><p><img src="img/15.png" alt=""></p><p>上一步提到的缓冲区经过运算变形(b)</p><p><img src="img/16.png" alt=""></p><p>通过之前的数据(a)(b)计算查表得到最终的注册码</p><p><img src="img/17.png" alt=""></p><h1 id="web"><a name="web" href="#web"></a>web</h1><h2 id="web1-100"><a name="web1-100" href="#web1-100"></a>web1-100</h2><p>这个问题在乌云社区讨论过，详情见<a href="http://zone.wooyun.org/content/20172">http://zone.wooyun.org/content/20172</a><br>随便拿其中一个就行了。</p><pre class="php hljs"><code class="php" data-origin="<pre><code class=&quot;php&quot;>&amp;lt;?php 
var_dump(md5('240610708') == md5('QNKCDZO')); 
var_dump(md5('aabg7XSs') == md5('aabC9RqS')); 
?&amp;gt;
</code></pre>"><span class="hljs-preprocessor">&lt;?php</span> 
var_dump(md5(<span class="hljs-string">'240610708'</span>) == md5(<span class="hljs-string">'QNKCDZO'</span>)); 
var_dump(md5(<span class="hljs-string">'aabg7XSs'</span>) == md5(<span class="hljs-string">'aabC9RqS'</span>)); 
<span class="hljs-preprocessor">?&gt;</span>
</code></pre><h2 id="web1-200"><a name="web1-200" href="#web1-200"></a>web1-200</h2><p>先查看页面源码，发现一个examples目录。进去发现要登录，提示说</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>Let Me Guess.. U 4re N0t Administrator!!!
</code></pre>">Let Me Guess.. U <span class="hljs-number">4</span>re N0t Administrator!!!
</code></pre><p>然后尝试了很久的注入，并没有成功。然后放到扫描器里面一扫，有惊喜。</p><p><img src="img/web1-200-1.jpg" alt="web1-200-1.jpg"></p><p><a href="http://flagbox-23031374.xdctf.win:1234/examples/servlets/servlet/SessionExample">http://flagbox-23031374.xdctf.win:1234/examples/servlets/servlet/SessionExample</a></p><p>看到这个之后，就觉得是session操作。然后输入user=Administrator</p><p><img src="img/web1-200-2.jpg" alt="web1-200-2.jpg"></p><p>然后提示，not login。然后把login改为1。在这个点的时候，我尝试了很多改cookie啥的。发现总是不行。</p><p>后面发现要把login改为true，也是醉了。</p><p><img src="img/web1-200-3.jpg" alt="web1-200-3.jpg"></p><h2 id="web1-300"><a name="web1-300" href="#web1-300"></a>web1-300</h2><p>这是一个ssrf，一去进去就是一个框框。直接尝试file://index.php 然后就把index.php的源码读到了。</p><pre class="php hljs"><code class="php" data-origin="<pre><code class=&quot;php&quot;>&amp;lt;?php
        if (isset($_GET['link'])) {
            $link = $_GET['link'];
            // disable sleep
            if (strpos(strtolower($link), 'sleep') || strpos(strtolower($link), 'benchmark')) {
                die('No sleep.');
            }

            if (strpos($link,&quot;http://&quot;) === 0) {
                // http
                $curlobj = curl_init($link);
                curl_setopt($curlobj, CURLOPT_HEADER, 0);
                curl_setopt($curlobj, CURLOPT_PROTOCOLS, CURLPROTO_HTTP);
                curl_setopt($curlobj, CURLOPT_CONNECTTIMEOUT, 10);
                curl_setopt($curlobj, CURLOPT_TIMEOUT, 5);
                $content = curl_exec($curlobj);
                curl_close($curlobj);
                echo $content;

            } elseif (strpos($link,&quot;file://&quot;) === 0) {
                // file
                echo file_get_contents(substr($link, 7));
            }

        } else {
            echo&amp;lt;&amp;lt;&amp;lt;EOF
        &amp;lt;!--你瞅啥--&amp;gt;
</code></pre>"><span class="hljs-preprocessor">&lt;?php</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'link'</span>])) {
            <span class="hljs-variable">$link</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'link'</span>];
            <span class="hljs-comment">// disable sleep</span>
            <span class="hljs-keyword">if</span> (strpos(strtolower(<span class="hljs-variable">$link</span>), <span class="hljs-string">'sleep'</span>) || strpos(strtolower(<span class="hljs-variable">$link</span>), <span class="hljs-string">'benchmark'</span>)) {
                <span class="hljs-keyword">die</span>(<span class="hljs-string">'No sleep.'</span>);
            }

            <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$link</span>,<span class="hljs-string">"http://"</span>) === <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// http</span>
                <span class="hljs-variable">$curlobj</span> = curl_init(<span class="hljs-variable">$link</span>);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_PROTOCOLS, CURLPROTO_HTTP);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_CONNECTTIMEOUT, <span class="hljs-number">10</span>);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_TIMEOUT, <span class="hljs-number">5</span>);
                <span class="hljs-variable">$content</span> = curl_exec(<span class="hljs-variable">$curlobj</span>);
                curl_close(<span class="hljs-variable">$curlobj</span>);
                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;

            } <span class="hljs-keyword">elseif</span> (strpos(<span class="hljs-variable">$link</span>,<span class="hljs-string">"file://"</span>) === <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// file</span>
                <span class="hljs-keyword">echo</span> file_get_contents(substr(<span class="hljs-variable">$link</span>, <span class="hljs-number">7</span>));
            }

        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">echo</span><span class="hljs-string">&lt;&lt;&lt;EOF
        &lt;!--你瞅啥--&gt;
</span></code></pre><p>然后继续读取文件。读hosts文件</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;># The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
127.0.0.1    9bd5688225d90ff2a06e2ee1f1665f40.xdctf.com
</code></pre>"><span class="hljs-comment"># The following lines are desirable for IPv6 capable hosts</span>
::<span class="hljs-number">1</span>     localhost ip6-localhost ip6-loopback
ff02::<span class="hljs-number">1</span> ip6-allnodes
ff02::<span class="hljs-number">2</span> ip6-allrouters
<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>    <span class="hljs-number">9</span>bd5688225d90ff2a06e2ee1f1665f40.xdctf.com
</code></pre><p>然后看到一个绑定hosts的地址。然后去访问发现就是这个页面，看到这个经验告诉我这上面肯定还有其他的网站，不然没有必要绑定host。然后就想去读nginx的配置文件，fuzz了很久都没读取到。后面就想想会不会是在其他的端口，然后开burp爆破。</p><p><img src="img/web1-300-1.jpg" alt="web1-300-1.jpg"></p><p>好家伙，果然有猫腻。3389端口是个dz7.2.然后打了一发faq的注入，发现不行。然后还是回到死胡同去猜文件路径，然后去读uc key。因为我以为uckey就是flag。后面再这里卡了很久，然后最后发现faq注入没成功的原因是因为编码问题，需要urlencode一下。这个解决后，那就直接上sqlmap跑。最后发现admin的密码就是flag</p><p><img src="img/web1-300-2.jpg" alt="web1-300-2.jpg"></p><h2 id="web1-400"><a name="web1-400" href="#web1-400"></a>web1-400</h2><p>这个题目是给了提示之后才做出来的，给的提示是” 然后就去测试，其中在那个图片内容最下面提示你</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>&amp;lt;!--Please input the ID as parameter with numeric value--&amp;gt;
</code></pre>">&lt;!--Please input the ID as parameter with numeric value--&gt;
</code></pre><p>先测试<br><a href="http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3</a>“ or 1%23<br>返回图片<br><a href="http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3</a>“ or 0%23<br>返回Picture not found!<br>很明显这是一个盲注。然后继续测试，发现过滤了很多东西，一旦出现select substr left right ascii mid<br>这些关键字是永真。然后一直在fuzz，最后发现学长写的一篇文章<a href="http://laterain.sinaapp.com/?p=196">http://laterain.sinaapp.com/?p=196</a> 提到了一种正则盲注的方法</p><pre><code data-origin="<pre><code>http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or user() REGEXP '^1' %23 为假
</code></pre>">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or user() REGEXP '^1' %23 为假
</code></pre><pre><code data-origin="<pre><code>http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or user() REGEXP '^x' %23 为真
</code></pre>">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or user() REGEXP '^x' %23 为真
</code></pre><p>说明user()是已x开头。然后就这样猜解。但是到后面准备猜解其他表的内容，要用到select。但是这个是直接匹配的select，并不是检查的连接处。后面想起这个案例<br><a href="http://www.wooyun.org/bugs/wooyun-2015-0101960">http://www.wooyun.org/bugs/wooyun-2015-0101960</a><br>会不会我们要猜的数据就和当前的数据在通一个表里面呢。<br>然后经过一顿fuzz之后，好家伙果然就是这个。</p><pre><code data-origin="<pre><code>http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or password REGEXP '^1' %23  为假
</code></pre>">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or password REGEXP '^1' %23  为假
</code></pre><pre><code data-origin="<pre><code>http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or password REGEXP '^5' %23 为真
</code></pre>">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or password REGEXP '^5' %23 为真
</code></pre><p>说明password字段的第一个值为5开头。然后就这样一直跑最后得到hash 5832f4251cb6f43917df<br>二十位的hash让我想起了dede，然后去掉前三后一解密</p><pre><code data-origin="<pre><code>2f4251cb6f43917d    md5    lu5631209
</code></pre>">2f4251cb6f43917d    md5    lu5631209
</code></pre><p>然后登陆拿到flag</p><p><img src="img/web1-400.jpg" alt="web1-400.jpg"></p><h2 id="web2-200"><a name="web2-200" href="#web2-200"></a>web2-200</h2><p>先通过猪猪侠的脚本</p><pre><code data-origin="<pre><code>  &quot;files&quot;: {
    &quot;http://xdsec-cms-12023458.xdctf.win&quot;: {
      &quot;/.git/&quot;: [
        &quot;http://xdsec-cms-12023458.xdctf.win/.git/config&quot;
      ],
      &quot;/&quot;: [
        &quot;http://xdsec-cms-12023458.xdctf.win/index.php&quot;
      ]
    },
    &quot;http://xdsec-cms-12023458.xdctf.win/&quot;: {
      &quot;/index.php/&quot;: [
        &quot;misdescription cleaned&quot;
      ],
      &quot;/.git/&quot;: [
        &quot;http://xdsec-cms-12023458.xdctf.win/.git/config&quot;
      ],
      &quot;/&quot;: [
        &quot;http://xdsec-cms-12023458.xdctf.win/index.php&quot;
      ]
    }
  }
</code></pre>">  "files": {
    "http://xdsec-cms-12023458.xdctf.win": {
      "/.git/": [
        "http://xdsec-cms-12023458.xdctf.win/.git/config"
      ],
      "/": [
        "http://xdsec-cms-12023458.xdctf.win/index.php"
      ]
    },
    "http://xdsec-cms-12023458.xdctf.win/": {
      "/index.php/": [
        "misdescription cleaned"
      ],
      "/.git/": [
        "http://xdsec-cms-12023458.xdctf.win/.git/config"
      ],
      "/": [
        "http://xdsec-cms-12023458.xdctf.win/index.php"
      ]
    }
  }
</code></pre><p>发现有git泄露，然后用脚本下载</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>./rip-git.pl -v -u http://xdsec-cms-12023458.xdctf.win/
</code></pre>">./rip-git.pl -v -u http://xdsec-cms-<span class="hljs-number">12023458</span>.xdctf.win/
</code></pre><p>然后恢复源码</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>git log

git reset -hard d16ecb1
</code></pre>">git <span class="hljs-built_in">log</span>

git reset -hard d16ecb1
</code></pre><p>然后在index.php里面发现flag</p><pre><code data-origin="<pre><code>Congratulation, this is the [XDSEC-CMS] flag 1

XDCTF-{raGWvWahqZjww4RdHN90}
</code></pre>">Congratulation, this is the [XDSEC-CMS] flag 1

XDCTF-{raGWvWahqZjww4RdHN90}
</code></pre><h2 id="web2-100"><a name="web2-100" href="#web2-100"></a>web2-100</h2><p>看到了hint</p><pre><code data-origin="<pre><code>100 前台逻辑漏洞，做出此题可获得进入300的钥匙
</code></pre>">100 前台逻辑漏洞，做出此题可获得进入300的钥匙
</code></pre><p>然后又发现有人在ph这个用户里面发文章。觉得就是在找回密码这一块有问题，然后仔细看这一块的代码。<br>发现两个关键点</p><pre class="php hljs"><code class="php" data-origin="<pre><code class=&quot;php&quot;>public function handle_resetpwd()
    {
        if(empty($_GET[&quot;email&quot;]) || empty($_GET[&quot;verify&quot;])) {
            $this-&amp;gt;error(&quot;Bad request&quot;, site_url(&quot;auth/forgetpwd&quot;));
        }
        $user = $this-&amp;gt;user-&amp;gt;get_user(I(&quot;get.email&quot;), &quot;email&quot;);
        if(I('get.verify') != $user['verify']) {
            $this-&amp;gt;error(&quot;Your verify code is error&quot;, site_url('auth/forgetpwd'));
        }
        if($this-&amp;gt;input-&amp;gt;method() == &quot;post&quot;) {
            $password = I(&quot;post.password&quot;);
            if(!$this-&amp;gt;confirm_password($password)) {
                $this-&amp;gt;error(&quot;Confirm password error&quot;);
            }
            if(!$this-&amp;gt;complex_password($password)) {
                $this-&amp;gt;error(&quot;Password must have at least one alpha and one number&quot;);
            }
            if(strlen($password) &amp;lt; 8) {
                $this-&amp;gt;error(&quot;The Password field must be at least 8 characters in length&quot;);
            }
            $this-&amp;gt;user-&amp;gt;update_userinfo([
                &quot;password&quot; =&amp;gt; $password,
                &quot;verify&quot; =&amp;gt; null
            ], $user[&quot;uid&quot;]);
            $this-&amp;gt;success(&quot;Password update successful!&quot;, site_url(&quot;auth/login&quot;));
        } else {
            $url = site_url(&quot;auth/resetpwd&quot;) . &quot;?email={$user['email']}&amp;amp;verify={$user['verify']}&quot;;
            $this-&amp;gt;view(&quot;resetpwd.html&quot;, [&quot;form_url&quot; =&amp;gt; $url]);
        }
    }
</code></pre>"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle_resetpwd</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"email"</span>]) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"verify"</span>])) {
            <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Bad request"</span>, site_url(<span class="hljs-string">"auth/forgetpwd"</span>));
        }
        <span class="hljs-variable">$user</span> = <span class="hljs-variable">$this</span>-&gt;user-&gt;get_user(I(<span class="hljs-string">"get.email"</span>), <span class="hljs-string">"email"</span>);
        <span class="hljs-keyword">if</span>(I(<span class="hljs-string">'get.verify'</span>) != <span class="hljs-variable">$user</span>[<span class="hljs-string">'verify'</span>]) {
            <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Your verify code is error"</span>, site_url(<span class="hljs-string">'auth/forgetpwd'</span>));
        }
        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$this</span>-&gt;input-&gt;method() == <span class="hljs-string">"post"</span>) {
            <span class="hljs-variable">$password</span> = I(<span class="hljs-string">"post.password"</span>);
            <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$this</span>-&gt;confirm_password(<span class="hljs-variable">$password</span>)) {
                <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Confirm password error"</span>);
            }
            <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$this</span>-&gt;complex_password(<span class="hljs-variable">$password</span>)) {
                <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Password must have at least one alpha and one number"</span>);
            }
            <span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$password</span>) &lt; <span class="hljs-number">8</span>) {
                <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"The Password field must be at least 8 characters in length"</span>);
            }
            <span class="hljs-variable">$this</span>-&gt;user-&gt;update_userinfo([
                <span class="hljs-string">"password"</span> =&gt; <span class="hljs-variable">$password</span>,
                <span class="hljs-string">"verify"</span> =&gt; <span class="hljs-keyword">null</span>
            ], <span class="hljs-variable">$user</span>[<span class="hljs-string">"uid"</span>]);
            <span class="hljs-variable">$this</span>-&gt;success(<span class="hljs-string">"Password update successful!"</span>, site_url(<span class="hljs-string">"auth/login"</span>));
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable">$url</span> = site_url(<span class="hljs-string">"auth/resetpwd"</span>) . <span class="hljs-string">"?email={$user['email']}&amp;verify={$user['verify']}"</span>;
            <span class="hljs-variable">$this</span>-&gt;view(<span class="hljs-string">"resetpwd.html"</span>, [<span class="hljs-string">"form_url"</span> =&gt; <span class="hljs-variable">$url</span>]);
        }
    }
</code></pre><p>在这个函数里面首先我们要过这个判断</p><pre class="php hljs"><code class="php" data-origin="<pre><code class=&quot;php&quot;>if(empty($_GET[&quot;email&quot;]) || empty($_GET[&quot;verify&quot;])) {
            $this-&amp;gt;error(&quot;Bad request&quot;, site_url(&quot;auth/forgetpwd&quot;));
        }
</code></pre>"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"email"</span>]) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"verify"</span>])) {
            <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Bad request"</span>, site_url(<span class="hljs-string">"auth/forgetpwd"</span>));
        }
</code></pre><p>email在源码中给出来了</p><pre><code class="html" data-origin="<pre><code class=&quot;html&quot;>&amp;lt;meta name=&quot;author&quot; content=&quot;xdsec-cms@xdctf.com&quot;/&amp;gt;
</code></pre>">&lt;meta name="author" content="xdsec-cms@xdctf.com"/&gt;
</code></pre><p>然后verify这个是找回密码的一个验证key。其生成方式是md5(uniqid(mt_rand()))，开始想着是不是这个值可以预测，然后决定自己太天真了。我们继续往下面看代码</p><pre class="php hljs"><code class="php" data-origin="<pre><code class=&quot;php&quot;>$this-&amp;gt;user-&amp;gt;update_userinfo([
                &quot;password&quot; =&amp;gt; $password,
                &quot;verify&quot; =&amp;gt; null
            ], $user[&quot;uid&quot;]);
</code></pre>"><span class="hljs-variable">$this</span>-&gt;user-&gt;update_userinfo([
                <span class="hljs-string">"password"</span> =&gt; <span class="hljs-variable">$password</span>,
                <span class="hljs-string">"verify"</span> =&gt; <span class="hljs-keyword">null</span>
            ], <span class="hljs-variable">$user</span>[<span class="hljs-string">"uid"</span>]);
</code></pre><p>这段代码说明，每次在找回密码之后都会把verify重置为NULL。好家伙，感觉问题的关键就在这里了。然后我自己写一段测试代码</p><pre class="php hljs"><code class="php" data-origin="<pre><code class=&quot;php&quot;>&amp;lt;?php
$conn = mysql_connect(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;&quot;);

mysql_select_db(&quot;mysql&quot;, $conn);

$sql1 = &quot;update `user` SET password = NULL where host = 'locathost' &quot;;

$sql2 = &quot;select password from user where host='localhost' limit 1,1&quot;;

mysql_query($sql1);

$result = mysql_query($sql2);

while($row = mysql_fetch_array($result))
  {
    var_dump($row['password']);
  }

$id = @$_GET['id'];

if($id == $row['password']){

  echo 'success';

}
?&amp;gt;
</code></pre>"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-variable">$conn</span> = mysql_connect(<span class="hljs-string">"127.0.0.1"</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">""</span>);

mysql_select_db(<span class="hljs-string">"mysql"</span>, <span class="hljs-variable">$conn</span>);

<span class="hljs-variable">$sql1</span> = <span class="hljs-string">"update `user` SET password = NULL where host = 'locathost' "</span>;

<span class="hljs-variable">$sql2</span> = <span class="hljs-string">"select password from user where host='localhost' limit 1,1"</span>;

mysql_query(<span class="hljs-variable">$sql1</span>);

<span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql2</span>);

<span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span> = mysql_fetch_array(<span class="hljs-variable">$result</span>))
  {
    var_dump(<span class="hljs-variable">$row</span>[<span class="hljs-string">'password'</span>]);
  }

<span class="hljs-variable">$id</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>];

<span class="hljs-keyword">if</span>(<span class="hljs-variable">$id</span> == <span class="hljs-variable">$row</span>[<span class="hljs-string">'password'</span>]){

  <span class="hljs-keyword">echo</span> <span class="hljs-string">'success'</span>;

}
<span class="hljs-preprocessor">?&gt;</span>
</code></pre><p>当我id穿入一个空格的是时候打印的是success，这就证明php在做比较的时候把空格和NULL相等了。</p><p>然后回到CMS里面，我们将verify赋为空格，然后成功重置ph用户的密码。</p><p><img src="img/web2-100.jpg" alt="web2-100.jpg"></p><p>登录进去之后就发现了flag</p><p>其实发现网站上的源码和本地的源码不一样，因为我点击找回密码之后。应该生成了一个verify到数据，但是这个时候数据库的verify并没有生成。因为我通过空格还是成功修改了密码。</p><h1 id="misc"><a name="misc" href="#misc"></a>Misc</h1><h2 id="misc100"><a name="misc100" href="#misc100"></a>Misc100</h2><p>根据官方提示braiontools github下载下来，按照帮助手册<br><code>bftools.exe decode braincopter zzzzzyu.png --output --out.png</code><br>用winhex将out.png打开将里边的内容丢到<a href="http://esoteric.sange.fi/brainfuck/impl/interp/i.html">http://esoteric.sange.fi/brainfuck/impl/interp/i.html</a><br>解一下就可以了。</p><h2 id="misc200"><a name="misc200" href="#misc200"></a>Misc200</h2><p>将areyoukiding丢kali中，binwalk看一下，发现有2个readme.txt，1个flag.txt，查资料查到<a href="http://bbs.csdn.net/topics/10444536">http://bbs.csdn.net/topics/10444536</a> ，用winhex将未加密的readme和加密的readme 和flag扣出来用二楼的方法就可以了。</p><h1 id="pwn"><a name="pwn" href="#pwn"></a>Pwn</h1><h2 id="pwn100"><a name="pwn100" href="#pwn100"></a>pwn100</h2><p>用瀚海源的 文件b超.<br><a href="https://b-chao.com/">https://b-chao.com/</a><br><img src="img/pwn100_1.png" alt=""></p><h2 id="pwn200"><a name="pwn200" href="#pwn200"></a>pwn200</h2><p>漏洞很明显,但没有libc,之前想着dump内存,把libc dump出来的,没弄好,后来找了个模板改下了就好了. </p><p><a href="https://github.com/inaz2/roputils/blob/master/examples/dl-resolve-i386.py">dl-resolve-i386.py</a></p><h2 id="pwn300"><a name="pwn300" href="#pwn300"></a>pwn300</h2><p>程序自己写了个堆管理,然后有个堆溢出.通过edit修改堆的类型即可覆盖下一个堆的结构,接着用del阔以修改4个字节.</p><p>利用的话:<br>1:先修改存堆地址的那部分,0x0804b060,通过show_girl()来泄露堆地址<br>2:在堆里放shellcode,然后修改got_exit()指向shellcode</p><h2 id="pwn400"><a name="pwn400" href="#pwn400"></a>pwn400</h2><p>整型溢出<br>如下图所示,在sub_8048c86()的函数调用中,v13 是个2字节的变量,并且是可控的,前面的判断逻辑即可使(v13+2)溢出来绕过<br><img src="img/pwn400_1.png" alt=""></p><p>在sub_8048c86中,这里传递n是一个大数,就阔以读取到flag了.<br><img src="img/pwn400_2.png" alt=""></p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
